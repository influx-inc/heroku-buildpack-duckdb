#!/usr/bin/env bash
# Export build-time environment variables so subsequent buildpacks (heroku/ruby)
# can find duckdb.h and libduckdb.so when compiling the duckdb gem.
#
# BUNDLE_BUILD__DUCKDB passes --with-duckdb-dir to extconf.rb, which uses
# dir_config('duckdb') to locate the header and shared library.
# BUILD_DIR is set by Heroku before sourcing this script.

DUCKDB_DIR="$BUILD_DIR/.duckdb"

export LIBRARY_PATH="${DUCKDB_DIR}/lib${LIBRARY_PATH:+:$LIBRARY_PATH}"
export LD_LIBRARY_PATH="${DUCKDB_DIR}/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"
export BUNDLE_BUILD__DUCKDB="--with-duckdb-dir=${DUCKDB_DIR}"
